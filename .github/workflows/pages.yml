name: Deploy to GitHub Pages

on:
  push:
    branches:
      - main

permissions:
  contents: write  # peaceiris éœ€è¦å†™æƒé™

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: ğŸ“„ Write version info (no tag)
        run: |
            HASH=$(git rev-parse --short HEAD)
            COUNT=$(git rev-list --count HEAD)
            BUILD_TIME=$(date -u +%Y-%m-%dT%H:%M:%SZ)
            VERSION="r$COUNT-g$HASH"
            echo "{ \"version\": \"$VERSION\", \"deployedAt\": \"$BUILD_TIME\" }" > version.json
      - name: Deploy
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: .  # éƒ¨ç½²æ ¹ç›®å½•ï¼ˆå³å½“å‰ index.html æ‰€åœ¨ä½ç½®ï¼‰
